<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LOL 5대5 팀 메이커</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        input, button, select {
            margin: 5px;
            padding: 5px;
        }
        #result {
            margin-top: 20px;
        }
        .team-option {
            border: 2px solid #ccc;
            padding: 10px;
            margin-bottom: 20px;
        }
        .team {
            margin-bottom: 5px;
        }
        .team-name {
            font-weight: bold;
        }
        .horizontal-line {
            border-top: 1px solid #ccc;
            margin: 5px 0;
        }
        #groupsSection {
            margin-top: 20px;
            border: 1px solid #ddd;
            padding: 10px;
        }
        .group {
            margin-bottom: 10px;
            padding: 10px;
            border: 1px solid #eee;
        }
        .removeGroup {
            color: red;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <h1>LOL 5대5 팀 메이커</h1>
    <div id="inputs">
        <input type="text" id="player1" placeholder="플레이어 1">
        <input type="text" id="player2" placeholder="플레이어 2">
        <input type="text" id="player3" placeholder="플레이어 3">
        <input type="text" id="player4" placeholder="플레이어 4">
        <input type="text" id="player5" placeholder="플레이어 5">
        <input type="text" id="player6" placeholder="플레이어 6">
        <input type="text" id="player7" placeholder="플레이어 7">
        <input type="text" id="player8" placeholder="플레이어 8">
        <input type="text" id="player9" placeholder="플레이어 9">
        <input type="text" id="player10" placeholder="플레이어 10">
    </div>
    <div id="groupsSection">
        <h3>팀 분리/결합 그룹 설정</h3>
        <button onclick="addGroup()">새 그룹 추가</button>
        <div id="groups"></div>
    </div>
    <button onclick="makeTeams()">팀 만들기</button>
    <div id="result"></div>

    <script>
        let groupCounter = 0;

        function addGroup() {
            groupCounter++;
            const groupDiv = document.createElement('div');
            groupDiv.className = 'group';
            groupDiv.innerHTML = `
                <h4>그룹 ${groupCounter} <span class="removeGroup" onclick="removeGroup(this)">✖</span></h4>
                <select multiple class="groupPlayers"></select>
                <br>
                <label>
                    <input type="radio" name="group${groupCounter}" value="same" checked> 같은 팀
                </label>
                <label>
                    <input type="radio" name="group${groupCounter}" value="different"> 다른 팀
                </label>
            `;
            document.getElementById('groups').appendChild(groupDiv);
            updatePlayerOptions();
        }

        function removeGroup(element) {
            element.closest('.group').remove();
        }

        function updatePlayerOptions() {
            const players = getPlayers();
            const selects = document.querySelectorAll('.groupPlayers');
            selects.forEach(select => {
                const selectedValues = Array.from(select.selectedOptions).map(option => option.value);
                select.innerHTML = '';
                players.forEach((player, index) => {
                    if (player) {
                        const option = document.createElement('option');
                        option.value = index;
                        option.textContent = player;
                        option.selected = selectedValues.includes(index.toString());
                        select.appendChild(option);
                    }
                });
            });
        }

        function getPlayers() {
            return Array.from({ length: 10 }, (_, i) => document.getElementById(`player${i + 1}`).value.trim());
        }

        function makeTeams() {
            const players = getPlayers().filter(player => player);
            if (players.length !== 10) {
                alert('정확히 10명의 플레이어를 입력해주세요!');
                return;
            }

            const groups = Array.from(document.querySelectorAll('.group')).map(group => ({
                players: Array.from(group.querySelector('.groupPlayers').selectedOptions).map(option => parseInt(option.value)),
                type: group.querySelector('input[type="radio"]:checked').value
            }));

            const teamOptions = [];
            for (let i = 0; i < 4; i++) {
                const team1 = [];
                const team2 = [];
                const unassigned = new Set(players.keys());

                // 그룹 규칙에 따라 플레이어 할당
                groups.forEach(group => {
                    if (group.type === 'same') {
                        const targetTeam = Math.random() < 0.5 ? team1 : team2;
                        group.players.forEach(playerIndex => {
                            if (unassigned.has(playerIndex)) {
                                targetTeam.push(players[playerIndex]);
                                unassigned.delete(playerIndex);
                            }
                        });
                    } else {
                        let team1Added = false;
                        group.players.forEach(playerIndex => {
                            if (unassigned.has(playerIndex)) {
                                if (!team1Added && team1.length < 5) {
                                    team1.push(players[playerIndex]);
                                    team1Added = true;
                                } else if (team2.length < 5) {
                                    team2.push(players[playerIndex]);
                                }
                                unassigned.delete(playerIndex);
                            }
                        });
                    }
                });

                // 남은 플레이어 무작위 할당
                const remainingPlayers = Array.from(unassigned).map(index => players[index]);
                while (remainingPlayers.length > 0) {
                    const playerIndex = Math.floor(Math.random() * remainingPlayers.length);
                    const player = remainingPlayers.splice(playerIndex, 1)[0];
                    if (team1.length < 5) {
                        team1.push(player);
                    } else {
                        team2.push(player);
                    }
                }

                teamOptions.push({ team1, team2 });
            }

            // 중복 제거 및 최대 4개의 유니크한 옵션 선택
            const uniqueOptions = [];
            teamOptions.forEach(option => {
                if (!uniqueOptions.some(uniqueOption => 
                    (uniqueOption.team1.join(' ') === option.team1.join(' ') && uniqueOption.team2.join(' ') === option.team2.join(' ')) ||
                    (uniqueOption.team1.join(' ') === option.team2.join(' ') && uniqueOption.team2.join(' ') === option.team1.join(' '))
                )) {
                    uniqueOptions.push(option);
                }
            });

            displayTeams(uniqueOptions.slice(0, 4));
        }

        function displayTeams(teamOptions) {
            let resultHTML = '';
            teamOptions.forEach((option, index) => {
                resultHTML += `
                    <div class="team-option">
                        <h3>옵션 ${index + 1}</h3>
                        <div class="team">
                            <span class="team-name">팀 1:</span> ${option.team1.join(' ')}
                        </div>
                        <div class="horizontal-line"></div>
                        <div class="team">
                            <span class="team-name">팀 2:</span> ${option.team2.join(' ')}
                        </div>
                    </div>
                `;
            });
            document.getElementById('result').innerHTML = resultHTML;
        }

        // 플레이어 입력 필드의 변경을 감지하여 그룹 플레이어 선택 옵션 업데이트
        document.querySelectorAll('#inputs input').forEach(input => {
            input.addEventListener('input', updatePlayerOptions);
        });

        // 초기 그룹 추가
        addGroup();
    </script>
</body>
</html>